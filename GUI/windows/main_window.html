<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="../style/mainstyle.css" />
        <title>Laser-Tag 3000</title>
    </head>
    <body>
        <div id="background-container"></div>
        <div class="topbar">
            <button class="quit" type="button">&times;</button>
        </div>

        <header>
            <h1>Laser-Tag 3000</h1>
        </header>

        <div id="react-container"></div>

        <script type="text/javascript">
            let activeIDs = new Array();

            const addPlayer = event => {
                event.preventDefault();

                const playerName = document.getElementById("playerNameInput")
                    .value;
                const kitNumber = document.getElementById("kitNumberSelectAdd")
                    .value;

                if (!activeIDs.includes(kitNumber)) {
                    activeIDs.push(kitNumber);

                    wsClient.send(
                        JSON.stringify({
                            action: "addPlayer",
                            name: playerName,
                            id: kitNumber
                        })
                    );
                } else {
                    console.log(
                        "Player with ID " +
                            kitNumber +
                            " is already in the game"
                    );
                }
            };

            const removePlayer = event => {
                event.preventDefault();

                const kitNumber = document.getElementById(
                    "kitNumberSelectRemove"
                ).value;

                /*
                    If the ID is in the list of active ID's,
                    then remove the ID and request server
                    to remove it as well
                */
                let index = activeIDs.indexOf(kitNumber);
                if (index > -1) {
                    activeIDs.splice(index, 1);

                    wsClient.send(
                        JSON.stringify({
                            action: "removePlayer",
                            id: kitNumber
                        })
                    );
                } else {
                    console.log(
                        "Player with ID " + kitNumber + " is not in the game"
                    );
                }
            };

            const startGame = event => {
                event.preventDefault();

                const gametime = document.getElementById("gametime").value;

                if (gametime >= 10 && gametime <= 20) {
                    if (activeIDs.length > 1) {
                        wsClient.send(
                            JSON.stringify({
                                action: "startGame",
                                time: gametime
                            })
                        );
                    } else {
                        console.log("Not enough players");
                    }
                } else {
                    console.log("Gametime not withing range");
                }
            };
        </script>
        <script
            type="text/javascript"
            src="../scripts/websocketClient.js"
        ></script>
        <script src="../scripts/mainContent.js"></script>
    </body>
</html>
